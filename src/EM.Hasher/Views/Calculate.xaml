<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="EM.Hasher.Views.Calculate"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:EM.Hasher.Views"
    xmlns:localcontrols="using:EM.Hasher.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:toolkitConverters="using:CommunityToolkit.WinUI.Converters"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:viewmodels="using:EM.Hasher.ViewModels.Controls"
    xmlns:win="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    NavigationCacheMode="Required"
    mc:Ignorable="d">
    <Page.Resources>
        <!--  These styles can be referenced to create a consistent SettingsPage layout  -->

        <!--  Spacing between cards  -->
        <x:Double x:Key="SettingsCardSpacing">4</x:Double>

        <!--  Style (inc. the correct spacing) of a section header  -->
        <Style
            x:Key="SettingsSectionHeaderTextCaptionStyle"
            BasedOn="{StaticResource BodyStrongTextBlockStyle}"
            TargetType="TextBlock">
            <Style.Setters>
                <Setter Property="Margin" Value="5,2,5,5" />
                <Setter Property="FontSize" Value="18" />
            </Style.Setters>
        </Style>

        <Style
            x:Key="SettingsSectionHeaderTextBlockStyle"
            BasedOn="{StaticResource BodyStrongTextBlockStyle}"
            TargetType="TextBlock">
            <Style.Setters>
                <Setter Property="Margin" Value="5,10,0,5" />
            </Style.Setters>
        </Style>

        <toolkitConverters:BoolToVisibilityConverter x:Key="BoolToVisibility" />
        <toolkitConverters:BoolNegationConverter x:Key="BoolNegation" />

    </Page.Resources>
    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Disabled">
        <!--  disabled  -->
        <Grid>
            <StackPanel HorizontalAlignment="Stretch" Spacing="{StaticResource SettingsCardSpacing}">
                <win:StackPanel.ChildrenTransitions>
                    <win:EntranceThemeTransition FromVerticalOffset="50" />
                    <win:RepositionThemeTransition IsStaggeringEnabled="False" />
                </win:StackPanel.ChildrenTransitions>

                <TextBlock Style="{StaticResource SettingsSectionHeaderTextBlockStyle}" Text="File Information" />

                <controls:SettingsCard Margin="0,0,0,4">
                    <controls:SettingsCard.Header>
                        <localcontrols:FileInformationControl
                            FileCreated="{x:Bind ViewModel.FileCreated, Mode=OneWay}"
                            FileModified="{x:Bind ViewModel.FileModified, Mode=OneWay}"
                            FileName="{x:Bind ViewModel.FileName, Mode=OneWay}"
                            FileSize="{x:Bind ViewModel.FileSize, Mode=OneWay}" />
                    </controls:SettingsCard.Header>
                    <localcontrols:HandHoverGrid>
                        <localcontrols:IconButton
                            Width="40"
                            Height="40"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Command="{x:Bind ViewModel.OpenFileLocationCommand, Mode=OneWay}"
                            ToolTipService.ToolTip="Open file location">
                            <localcontrols:IconButton.Icon>
                                <FontIcon Glyph="&#xE8E5;" />
                                <!--  Open file icon  -->
                            </localcontrols:IconButton.Icon>
                        </localcontrols:IconButton>
                    </localcontrols:HandHoverGrid>
                </controls:SettingsCard>

                <TextBlock Style="{StaticResource SettingsSectionHeaderTextBlockStyle}" Text="Hash Information" />

                <ItemsControl ItemsSource="{x:Bind ViewModel.FileHashControlViewModels, Mode=OneWay}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:FileHashControlViewModel">
                            <controls:SettingsCard Margin="0,0,0,4" Visibility="{x:Bind IsEnabled, Mode=OneWay}">
                                <controls:SettingsCard.Header>
                                    <localcontrols:FileHashControl ViewModel="{x:Bind Mode=OneWay}" />
                                </controls:SettingsCard.Header>
                                <StackPanel Orientation="Horizontal">
                                    <localcontrols:HandHoverGrid>
                                        <localcontrols:IconButton
                                            Width="40"
                                            Height="40"
                                            Margin="0,0,6,0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Command="{x:Bind SearchHashCommand, Mode=OneWay}"
                                            ToolTipService.ToolTip="Search this hash on VirusTotal"
                                            Visibility="{x:Bind ShowVirusTotalSearch, Converter={StaticResource BoolToVisibility}, Mode=OneWay}">
                                            <localcontrols:IconButton.Icon>
                                                <FontIcon Glyph="&#xE721;" />
                                                <!--  Search icon  -->
                                            </localcontrols:IconButton.Icon>
                                        </localcontrols:IconButton>
                                    </localcontrols:HandHoverGrid>
                                    <localcontrols:HandHoverGrid>
                                        <localcontrols:CopyButton
                                            Width="40"
                                            Height="40"
                                            Command="{x:Bind CopyHashCommand, Mode=OneWay}"
                                            ToolTipService.ToolTip="Copy hash to clipboard"
                                            Visibility="{x:Bind IsCalculationComplete, Converter={StaticResource BoolToVisibility}, Mode=OneWay}" />
                                    </localcontrols:HandHoverGrid>
                                </StackPanel>
                            </controls:SettingsCard>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</Page>
